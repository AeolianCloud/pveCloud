# ================================================================
# pveCloud 业务后端配置文件
# ================================================================

# HTTP 服务器配置
server:
  port: "8080"                         # 监听端口

# MySQL 数据库配置
database:
  dsn: "pvecloud:bWhbdFFazxkh8XT7@tcp(127.0.0.1:3306)/pvecloud?charset=utf8mb4&parseTime=True&loc=Local"
  # DSN 格式: user:password@tcp(host:port)/dbname?charset=utf8mb4&parseTime=True&loc=Local

# JWT 鉴权配置
jwt:
  secret: "please-change-this-secret-in-production"  # 签名密钥，生产环境必须替换
  access_token_expire_hours: 2                        # Access Token 有效期（小时）
  refresh_token_expire_days: 7                        # Refresh Token 有效期（天）

# Redis 配置（用于 Token 黑名单、登录失败计数）
redis:
  addr: "127.0.0.1:6379"              # Redis 地址
  password: ""                         # 无密码时留空
  db: 0                                # 使用的数据库编号（0-15）

# PVE Client 实现模式
# mock: 使用模拟数据，无需真实 PVE 环境（开发阶段）
# http: 调用真实 PVE 能力后端（生产阶段，需填写下方 pve 配置）
pve_client_mode: "mock"

# PVE 能力后端配置（pve_client_mode=http 时生效）
pve:
  base_url: "https://pve-api.example.com"  # PVE 后端 API 基础地址（TODO: 等待 API 文档确认）
  api_key: "replace-with-real-api-key"     # API 认证 Key（TODO: 认证方式待确认）
  api_secret: "replace-with-real-api-secret" # API 认证 Secret
  timeout_seconds: 8                       # 单次请求超时时间（秒）
  max_retries: 2                           # 失败最大重试次数
  retry_backoff_ms: 200                    # 重试间隔基础时间（毫秒，指数退避）
  circuit_failure_threshold: 5            # 熔断触发：连续失败次数阈值
  circuit_open_seconds: 30               # 熔断开启持续时间（秒），期间直接返回错误
